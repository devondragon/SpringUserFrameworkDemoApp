<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" layout:decorate="~{layout}">

<head>
	<title th:utext="#{page.title.update-password}">Update Password</title>
</head>

<body>
	<div layout:fragment="content">
		<section id="main_content" class="my-5">
			<div class="container">
				<div class="text-center mb-4">
					<h1 id="pageTitle" th:utext="#{password.update-password}">Update Password</h1>
				</div>

				<div id="globalMessage" class="alert text-center d-none"></div>
				<div id="setPasswordInfo" class="alert alert-info text-center d-none"><i class="bi bi-info-circle me-1"></i>You don't have a password yet. Set one to enable password login alongside your passkeys.</div>

				<!-- Update Password Form -->
				<div class="card shadow-sm">
					<div class="card-body">
						<form id="updatePasswordForm" th:action="@{/user/updatePassword}" method="POST">
							<!-- Current Password -->
							<div id="currentPasswordSection">
							<div class="row mb-3 align-items-center">
								<label for="currentPassword" class="col-sm-4 col-form-label" th:utext="#{label.user.old-password}">Current
									Password</label>
								<div class="col-sm-8">
									<input type="password" id="currentPassword" name="currentPassword" class="form-control" required>
									<div id="currentPasswordError" class="form-text text-danger d-none"></div>
								</div>
							</div>
							</div>

							<!-- New Password -->
							<div class="row mb-3 align-items-center">
								<label for="newPassword" class="col-sm-4 col-form-label" th:utext="#{label.user.new-password}">New Password</label>
								<div class="col-sm-8">
									<input type="password" id="newPassword" name="newPassword" class="form-control" required>
									<!-- Password Strength display -->
									<div id="password-strength" class="mt-1 d-none">
										<div id="strengthBar" class="progress">
											<div id="strengthLevel" class="progress-bar" role="progressbar"
												style="width: 0%;"></div>
										</div>
										<small id="strengthLabel" class="text-muted">Password strength: </small>
									</div>
									<!-- Password requirements displayed on focus -->
									<div id="password-requirements" class="form-text text-muted mt-1 d-none"
										style="font-size: 0.875rem;">
										<strong>Password must:</strong>
										<ul class="mb-0 ps-3">
											<li>Be at least <strong>8</strong> characters</li>
											<li>Include at least <strong>1 uppercase</strong> letter (A–Z)</li>
											<li>Include at least <strong>1 lowercase</strong> letter (a–z)</li>
											<li>Include at least <strong>1 digit</strong> (0–9)</li>
											<li>Include at least <strong>1 special</strong> character (~`!@#$%^&*()_-+={}[]|\:;"'&lt;&gt;,.?/)</li>
										</ul>
									</div>
									<div id="newPasswordError" class="form-text text-danger d-none"></div>
								</div>
							</div>

							<!-- Confirm New Password -->
							<div class="row mb-3 align-items-center">
								<label for="confirmPassword" class="col-sm-4 col-form-label" th:utext="#{label.user.confirm-password}">Confirm
									Password</label>
								<div class="col-sm-8">
									<input type="password" id="confirmPassword" name="confirmPassword" class="form-control" required>
									<div id="confirmPasswordError" class="form-text text-danger d-none"></div>
								</div>
							</div>

							<!-- Submit Button -->
							<div class="text-center">
								<button type="submit" class="btn btn-primary" th:utext="#{action.update-password}">Update Password</button>
							</div>
						</form>
					</div>
				</div>
			</div>
		</section>

		<script type="module" th:src="@{/js/user/update-password.js}"></script>
	</div>
</body>

</html>
